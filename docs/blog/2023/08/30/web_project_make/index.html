<!DOCTYPE html><html lang="en"><meta charset="utf-8"><title>creamycode</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="this is meta description"><meta name="theme-name" content="kross-jekyll" /><link rel="stylesheet" href="/assets/plugins/bootstrap/bootstrap.min.css"><link rel="stylesheet" href="/assets/plugins/themify-icons/themify-icons.css"><link rel="stylesheet" href="/assets/plugins/slick/slick.css"><link href="/assets/scss/style.css?1693396404314577000" rel="stylesheet"><link rel="shortcut icon" href="/assets/images/favicon.png " type="image/x-icon"><link rel="icon" href="/assets/images/favicon.png " type="image/x-icon"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet"> <script src="/assets/plugins/moment/moment.min.js"></script> <script src="/assets/plugins/search-bar/simple-jekyll-search.min.js"></script></head><header class="navigation fixed-top"><nav class="navbar navbar-expand-lg navbar-dark"> <a class="navbar-brand font-tertiary h3" href="/"><h3 class="text-white font-tertiary">creamycode</h3></a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button><div class="collapse navbar-collapse text-center" id="navigation"><ul class="navbar-nav ml-auto"><li class="nav-item active"> <a class="nav-link" href="/">Home</a></li><li class="nav-item "> <a class="nav-link" href="/about">About</a></li><li class="nav-item "> <a class="nav-link" href="/blog">Blog</a></li><li class="nav-item "> <a class="nav-link" href="/portfolio">Portfolio</a></li></ul></div></nav></header><section class="page-title bg-primary position-relative"><div class="container"><div class="row"><div class="col-12 text-center"><h1 class="text-white font-tertiary">Blogs</h1></div></div></div></section><section class="section"><div class="container"><div class="row"><div class="col-lg-12"><h3 class="font-tertiary">nx를 이용한 react, nestjs 기반 monorepo project 구성</h3><p class="font-secondary mb-0"> 2023-08-30</p><span class="tag">Monorepo </span><span class="tag">nx </span><span class="tag">pnpm </span><span class="tag">react </span><span class="tag">nestjs </span><hr><div class="content"> <img src="/assets/images/blog/2023/web_project-1.png" class="img-fluid rounded float-left mr-5 mb-4" alt="nx를 이용한 react, nestjs 기반 monorepo project 구성"><p> 현재 팀구성 및 개발환경을 고려한 web proejct 구성에 대한 검토 및 선정.</p><h1 id="web-project-구성">web project 구성</h1><h2 id="1-프로젝트-구성-방식---monorepo">1. 프로젝트 구성 방식 - Monorepo</h2><h3 id="monorepo-">Monorepo ?</h3><ul><li><a href="/blog/2023/08/30/monorepo/">이전글 참고</a></li></ul><h4 id="선정사유---backend-frontend-영역의-언어가-일치">선정사유 - backend, frontend 영역의 언어가 일치</h4><ul><li>두 영역간의 코드 공유가 손쉬움(DTO, 유효성처리, api요청 등등)</li><li>두 영역에서 일관된 개발자 경험 제공 (개발환경, lint, 코드 컨벤션)</li><li>의존성 관리 단일화 가능 (node-modules)</li></ul><h2 id="2-관련-기술-스택">2. 관련 기술 스택</h2><ul><li>package manager : npm, yarn, yarn2, pnpm</li><li>repo 구성관련 opensource : nx, turbo</li></ul><h3 id="21-package-manager---pnpm">2.1 package manager - pnpm</h3><p>Performent Node Package Manager : 빠르고 효율적인 javscript 패키지 매니저</p><h4 id="선정사유">선정사유</h4><ul><li>1세대 저수준 Package Manager 제외 - npm, yarn</li><li><a href="https://pnpm.io/ko/benchmarks">준수한 성능</a></li><li>yarn2와 pnpm의 기능제공 범위도 거의 유사하나 pnpm이 [트렌드에서 높음]:https://npmtrends.com/pnpm-vs-yarn</li><li>현 vdi 개발환경내에서 yarn의 경우 내부 repository 접근에 별도 설정이 필요한듯, pnpm은 기존 .npmrc로 이용가능</li></ul><h3 id="22-build-system---nx">2.2 Build System - NX</h3><ul><li><a href="https://nx.dev/">NX</a></li><li>최고 수준의 단일 저장소 지원 및 강력한 통합을 갖춘 차세대 빌드 시스템</li><li>구글 개발자들이 만든 오픈소스 프로젝트</li><li>Angular, React와 같은 프런트엔드 프레임워크 기반의 개발 환경 구성뿐 아니라 Express, Nest.js와 같은 백엔드 기술 기반의 개발까지 폭넓게 지원</li></ul><h4 id="주요-특징">주요 특징</h4><ul><li>로컬 및 CI에서 기존 프로젝트의 빌드 및 테스트 속도를 높입니다</li><li><strong>하위 수준 빌드 도구를 구성할 필요 없이 Nx 플러그인을 사용하여 새 프로젝트를 빠르게 생성가능(스캐폴드)</strong></li><li><strong>새로운 도구(예: Storybook, Tailwind 등)를 프로젝트에 쉽게 통합</strong></li><li>맞춤형 생성기와 Lint 규칙을 사용하여 일관성과 코드 품질을 보장</li><li>자동화된 코드 마이그레이션 기능을 사용하여 프레임워크와 도구를 업데이트하고 작업 공간을 상시 유지</li></ul><h4 id="선정사유-1">선정사유</h4><ul><li><strong>cli를 통한 손쉬운 프로젝트 구성 및 확장가능</strong><ul><li>별도의 설정 파일 수정 최소화</li><li>낮은 러닝커브</li></ul></li><li><strong>nx 전용 vscode extention 지원</strong><ul><li>cli 명령어 일일이 기억하지 않아도 됨</li></ul></li><li><a href="https://nx.dev/concepts/more-concepts/turbo-and-nx">turborepo와 비교</a><ul><li>turborepo의 경우 전용 cli의 수준이 너무 낮음<ul><li>프로젝트 확장시 turbo.json을 통해 구성 필요, 또한 신규 도구 추가에도 모두 수동 설정 필요</li></ul></li><li>turborepo의 경우 대규모 monorepo 환경에 기반하여 기본적으로 빌드 분산캐싱을 제공하며 이는 외부연결이 필요<ul><li>nx역시 nx-cloud를 통해 지원가능</li></ul></li></ul></li></ul><h2 id="3-nx-workspace-구성">3. nx workspace 구성</h2><h3 id="31-nx-workspace-구성-명령-수행">3.1 nx workspace 구성 명령 수행</h3><ul><li>package manager로 pnpm 지정</li></ul><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> npx create-nx-workspace@latest <span class="nt">--pm</span> pnpm
</code></pre></div></div><h3 id="32-workspace-기술스택-선택-및-자동-프로젝트-구성">3.2 workspace 기술스택 선택 및 자동 프로젝트 구성</h3><ul><li>우선 react기반으로 구성, stack 선택단계에서 None으로 시작해도 무방</li></ul><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>✔ Where would you like to create your workspace? · <span class="nb">test</span>
✔ Which stack <span class="k">do </span>you want to use? · react
✔ What framework would you like to use? · none
✔ Integrated monorepo, or standalone project? · integrated
✔ Application name · frontend
✔ Which bundler would you like to use? · vite
✔ Test runner to use <span class="k">for </span>end to end <span class="o">(</span>E2E<span class="o">)</span> tests · none
✔ Default stylesheet format · styled-components
✔ Enable distributed caching to make your CI faster · No  &lt;<span class="nt">--</span> nx cloud로 no로 선택
</code></pre></div></div><h3 id="33-nestjs-프로젝트-추가">3.3 nestjs 프로젝트 추가</h3><p>@nx/nestjs 플러그인 설치</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> pnpm add <span class="nt">-D</span> @nx/nest
</code></pre></div></div><p>nestjs project 추가</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># frontendProject 옵션은 해당 frontend app에 대한 proxy서버설정 처리지원</span>
<span class="o">&gt;</span> npx nx g @nx/nest:app &lt;프로젝트명&gt; <span class="nt">--frontendProject</span> frontend
</code></pre></div></div><p>nx project 제거</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> npx nx g <span class="nb">rm</span> &lt;프로젝트명&gt;
</code></pre></div></div><h3 id="34-공통-lib-프로젝트-추가">3.4 공통 lib 프로젝트 추가</h3><p>@nx/js 플러그인 설치</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pnpm add <span class="nt">-D</span> @nx/js
</code></pre></div></div><p>공통 lib 추가</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx nx g @nx/js:lib &lt;lib명&gt;
</code></pre></div></div><p>공통 ui lib 추가</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx nx g @nx/react:lib &lt;lib명&gt; <span class="nt">--bundler</span><span class="o">=</span>vite
</code></pre></div></div><h3 id="35-프로젝트-실행">3.5 프로젝트 실행</h3><p>단일 프로젝트에 대한 명령 수행</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># target은 serve, build 와 같은 명령어</span>
<span class="o">&gt;</span> npx nx &lt;target&gt; &lt;project&gt;
</code></pre></div></div><p>다수의 프로젝트에 대한 명령 수행</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -p 옵션 없을시 기본 전체</span>
npx nx run-many <span class="nt">-t</span> &lt;target&gt; <span class="nt">-p</span> &lt;project1&gt;, &lt;project2&gt;
</code></pre></div></div><h2 id="4-nx-핵심-기능">4. nx 핵심 기능</h2><h3 id="41-run-tasks">4.1 Run Tasks</h3><p>Monorepos에는 수백 또는 수천 개의 프로젝트가 있을 수 있으므로 프로젝트 전체(또는 일부)에 대해 작업을 실행할 수 있는 것</p><h3 id="42-cache-task-results">4.2 Cache Task Results</h3><p>동일한 코드를 계속해서 다시 빌드하고 다시 테스트하려면 비용이 많이 듭니다. Nx는 계산 캐시를 사용하여 동일한 코드를 두 번 다시 작성하지 않습니다.</p><h3 id="43-distribute-task-execution">4.3 Distribute Task Execution</h3><p>분산 CI 태스크 실행, nx cloud 사용필수</p><h3 id="44-explore-the-graph">4.4 Explore the Graph</h3><p>Nx는 작업을 빠르고 정확하게 실행할 수 있도록 저장소의 모든 프로젝트 간의 종속성에 대한 그래프를 생성합니다 . 이 그래프를 시각적으로 탐색하면 Nx가 특정 방식으로 작동하는 이유를 이해하고 코드 아키텍처에 대한 높은 수준의 보기를 얻는 데 유용할 수 있습니다.</p></div></div></div></div></section><section class="section"><div class="container"><div class="row"><div class="col-12 text-center"><h2 class="section-title">Similar Stories</h2></div><div class="col-lg-4 col-sm-6 mb-4"><article class="card shadow"> <img class="rounded card-img-top" src="/assets/images/blog/2023/web_project-1.png" alt="nx를 이용한 react, nestjs 기반 monorepo project 구성"><div class="card-body"><h4 class="card-title"> <a class="text-dark font-tertiary" href="/blog/2023/08/30/web_project_make/">nx를 이용한 react, nestjs 기반 monorepo project 구성</a></h4><p class="card-text"> 현재 팀구성 및 개발환경을 고려한 web proejct 구성에 대한 검토 및 선정.</p><a href="/blog/2023/08/30/web_project_make/" class="btn btn-xs btn-primary">Read More</a></div></article></div><div class="col-lg-4 col-sm-6 mb-4"><article class="card shadow"> <img class="rounded card-img-top" src="/assets/images/blog/2023/monorepo-1.png" alt="monorepo"><div class="card-body"><h4 class="card-title"> <a class="text-dark font-tertiary" href="/blog/2023/08/30/monorepo/">monorepo</a></h4><p class="card-text">1. Monorepo ?</p><a href="/blog/2023/08/30/monorepo/" class="btn btn-xs btn-primary">Read More</a></div></article></div><div class="col-lg-4 col-sm-6 mb-4"><article class="card shadow"> <img class="rounded card-img-top" src="/assets/images/blog/2023/jekyll-blog-1.png" alt="Jekyll과 github page를 이용한 블로그 2회차 구성기"><div class="card-body"><h4 class="card-title"> <a class="text-dark font-tertiary" href="/blog/2023/08/02/jekyll-blog/">Jekyll과 github page를 이용한 블로그 2회차 구성기</a></h4><p class="card-text"> 현재 재직중인 회사를 다닌지 5년차, 한창 포트폴리오를 갱신하며 겸사겸사 개인 블로그를 다시 만들었다. 이전에도 Jekyll을 이용한 개인 블로그가 있었지만, 빌드 구조와 디자인이 별로였고 많은 글을 쓰지 않았기에 repository를 삭제하는데 망설임은...</p><a href="/blog/2023/08/02/jekyll-blog/" class="btn btn-xs btn-primary">Read More</a></div></article></div></div></div></section><footer class="bg-dark footer-section"><div class="section"><div class="container"><div class="row"><div class="col-md-4"><h5 class="text-light">Email</h5><p class="text-white paragraph-lg font-secondary">creamycode87@gmail.com</p></div></div></div></div><div class="border-top text-center border-dark py-5"><p class="mb-0 text-light"><p>Copyright © 2020 Designed by <a href="https://themefisher.com">Themefisher</a> &amp; Developed by <a href="https://getjekyllthemes.com">Getjekyllthemes</a></p></p></div></footer><script src="/assets/plugins/jQuery/jquery.min.js"></script> <script src="/assets/plugins/bootstrap/bootstrap.min.js"></script> <script src="/assets/plugins/shuffle/shuffle.min.js"></script> <script src="/assets/plugins/slick/slick.min.js"></script> <script src="/assets/js/script.js?1693396404314577000"></script></body></html>
